---
# https://github.com/cloudalchemy/ansible-grafana

grafana_version: 7.0.3
grafana_skip_install: true
grafana_service_file_directory: /lib/systemd/system
grafana_config_directory: /usr/local/etc/grafana
grafana_binary_directory: /usr/local/bin
grafana_pid_file_directory: /var/run/grafana
grafana_yum_repo_template: etc/yum.repos.d/grafana.repo.j2
grafana_manage_repo: true

# Should we use the provisioning capability when possible (provisioning require grafana >= 5.0)
grafana_use_provisioning: true

# Should the provisioning be kept synced. If true, previous provisioned objects will be removed if not referenced anymore.
grafana_provisioning_synced: false

grafana_instance: "{{ inventory_hostname }}"

grafana_logs_dir: "/var/log/grafana"
grafana_data_dir: "/var/lib/grafana"

grafana_fqdn: "fypbcu.co.uk"
grafana_address: "127.0.0.1"
grafana_port: 9010
# To enable the use of ports below 1024 for unprivileged processes linux needs to set CAP_NET_BIND_SERVICE.
# This has some security implications, and should be a conscious choice.
# Get informed by reading: http://man7.org/linux/man-pages/man7/capabilities.7.html
grafana_cap_net_bind_service: false

# External Grafana address. Variable maps to "root_url" in grafana server section
grafana_url: "http://{{ grafana_fqdn }}:{{ grafana_port }}"
grafana_api_url: "{{ grafana_url }}"
grafana_domain: "{{ ansible_fqdn | default(ansible_host) | default('localhost') }}"

grafana_ini:
  - { section: users,
      option: allow_sign_up,
      value: false}
  - { section: auth.anonymous,
      option: enabled,
      value: false}
  - { section: smtp,
      option: enabled,
      value: true}
  - { section: smtp,
      option: user,
      value: admin@fypbcu.co.uk}

# Additional options for grafana "server" section
# This section WILL omit options for: http_addr, http_port, domain, and root_url, as those settings are set by variables listed before
grafana_server:
  protocol: http
  enforce_domain: false
  socket: "/tmp/grafana.sock"
  cert_key: ""
  cert_file: ""
  enable_gzip: false
  static_root_path: public
  router_logging: false
  serve_from_sub_path: false

# Database setup
grafana_database:
  type: sqlite3
  host: 127.0.0.1:3306
  name: grafana
  user: root
  password: "grafanadatapass"

# Variables correspond to ones in grafana.ini configuration file
# Security
grafana_security:
  disable_initial_admin_creation: false
  admin_user: admin
  admin_password: "grafanapass"
  secret_key: "SW2YcwTIb9zpOOhoPsMm"

# Set this for mail notifications
grafana_smtp:
  host: ssl0.ovh.net:456
  user: admin@fypbcu.co.uk
  password: Spectrum1000
  skip_verify: true
  from_address: admin@fypbcu.co.uk
  from_name: FYP_Project
  ehlo_identity: admin@fypbcu.co.uk

# User management and registration
grafana_welcome_email_on_sign_up: true
templates_pattern: emails/*.html
